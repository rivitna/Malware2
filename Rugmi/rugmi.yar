/*
Rugmi malware
*/


rule Rugmi_Loader
{
    meta:
        author = "rivitna"
        family = "rugmi.loader"
        description = "Rugmi malware loader"
        severity = 10
        score = 100

    strings:
        $h0 = { 81 E2 55 55 55 55 33 D0 8B CA C1 E9 02 8D 04 95 00 00 00 00
                33 C8 8D 04 95 00 00 00 00 81 E1 33 33 33 33 33 C8 8B C1
                C1 E9 04 25 0F 0F 0F FF C1 E0 04 }

    condition:
        ((uint16(0) == 0x5A4D) and (uint32(uint32(0x3C)) == 0x00004550)) and
        (
            (1 of ($h*))
        )
}


rule Rugmi_Stage2
{
    meta:
        author = "rivitna"
        family = "rugmi.stage2"
        description = "Rugmi malware loader stage #2"
        severity = 10
        score = 100

    condition:
        (filesize >= 20000) and (filesize <= 100000) and
        (uint32(0) == 0xFFBEEEDD) and
        (uint16(4) ^ uint16(204) == 0x5A4D)
}
